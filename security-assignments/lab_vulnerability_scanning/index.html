<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link type="text/plain" rel="author" href="/humans.txt" />
  <link rel="shortcut icon" href="/favicon.ico?v=92502d237dc856d080ccef6ea6f23eeb27ec96ab">

  <link href="/assets/css/bootstrap-custom.css?v=92502d237dc856d080ccef6ea6f23eeb27ec96ab" rel="stylesheet" media="screen">
  <link href="/assets/css/style.css?v=92502d237dc856d080ccef6ea6f23eeb27ec96ab" rel="stylesheet" media="screen">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  <script src="/assets/vendor/jquery/dist/jquery.min.js"></script>

  
      <link type="application/atom+xml" rel="alternate" href="https://daveeargle.com/feed.xml" title="Dave Eargle" />
<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Lab – Vulnerability Scanning | Dave Eargle</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Lab – Vulnerability Scanning" />
<meta name="author" content="deargle" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="exploration via nmap and nessus" />
<meta property="og:description" content="exploration via nmap and nessus" />
<link rel="canonical" href="https://daveeargle.com/security-assignments/lab_vulnerability_scanning/" />
<meta property="og:url" content="https://daveeargle.com/security-assignments/lab_vulnerability_scanning/" />
<meta property="og:site_name" content="Dave Eargle" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@deargle" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Lab – Vulnerability Scanning","url":"https://daveeargle.com/security-assignments/lab_vulnerability_scanning/","author":{"@type":"Person","name":"deargle"},"description":"exploration via nmap and nessus","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
      
  

</head>
<body class="tony-assignment post-security-assignments-lab_vulnerability_scanning" id="/security-assignments/lab_vulnerability_scanning">

<div class="container">

  
  
  

  
  <div class="content" id="content" role="main">


<h1 class='title'>Lab &ndash; Vulnerability Scanning</h1> 



<p>See <a href='/security-assignments/virtual-machines/#setting-up-virtualbox-and-the-infoset-net-network'>here</a> for instructions on setting up virtualbox for this class.</p>

<div class='alert alert-info'><strong>Heads up!</strong> Be sure that you have created the <code>infosec-net</code> virtualbox network, as specified at the top of the above link, <i>before</i> importing the vm! It's not the end of the world if you don't, but it does require some extra work.</div>

<p>This lab uses the following <a href='/security-assignments/virtual-machines/#the-virtual-machines'>vms:</a></p>
<ul>

    <li>Kali</li>

    <li>Metasploitable2</li>

</ul>



<div class="alert alert-warning">Ensure that you can <code>ping</code> Metasploitable2 from Kali, and Kali from Metasploitable2, before continuing the lab. Use the addresses shown in the <a href="/security-assignments/virtual-machines/#infosec-net-network-map">infosec-net network map</a>.</div>

<h1 id="objective">Objective</h1>

<p>The objective of this lab is to create a report of potential vulnerabilities for a virtual machine. The deliverable for this lab is your report and this document with your answers to questions below (submitted on D2L). 
The VM is a Ubuntu-based Linux distribution called MetaSploitable2, which is specifically designed to teach penetration testing skills such as vulnerability scanning.</p>

<h1 id="part-1-host-discovery-and-scanning-using-nmap">Part 1. Host Discovery and Scanning using NMAP</h1>

<p>NMAP is the de facto standard of host discovery and port scanning and has a host of features that make the tool very robust. In this section of the lab, you’ll try a few of NMAP’s features.</p>

<div class="alert alert-info">Throughout the lab, you should replace <code>&lt;IP.addr.of.metasploitable2&gt;</code> with the actual IPv4 address of Metasploitable.</div>

<ol>
  <li>Open a “Terminal Emulator” window in Kali.</li>
  <li>Run <code class="highlighter-rouge">nmap</code>. Take a quick look at the available options.</li>
  <li>
    <p>Use <code class="highlighter-rouge">nmap</code> to determine whether the your Metasploitable2 VM is live using a “ping scan”:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sn &lt;IP.addr.of.metasploitable2&gt;
</code></pre></div>    </div>

    <p>The ping scan not only sends an ICMP request, but also an ARP ping, TCP pinging, and other techniques to determine if a host is live on the network.</p>

    <div class="alert alert-warning"><strong>Question: </strong>What kind of information is shown when you run this ping scan for Metasploitable2?</div>

    <p>You can also scan a range of IPs using <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation">CIDR block notation</a>. See the <a href="/security-assignments/virtual-machines/#infosec-net-network-map">network map</a> for the ipv4 block of the infosec-net network. 
This can be fun to do if you also have your vuln Windows 10 vm running at the same time, although this is not required.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sn &lt;ipv4 CIDR block&gt;
</code></pre></div>    </div>

    <p>You can know your network by typing <code class="highlighter-rouge">ifconfig</code> on either Kali or Metasploitable, and looking for the <code class="highlighter-rouge">inet</code> address plus the <code class="highlighter-rouge">mask</code> value on the same line. 
For example, a “mask” of <code class="highlighter-rouge">255.255.255.0</code> applied to an “inet” address of 192.168.56.17 translates to a network of 192.168.56.0/24. 
(Where 24 is the number of bits to mask and it takes 8 bits to make 255, 8x3=24, so that would mask three of the ‘.’ blocks.)</p>
  </li>
  <li>
    <p>Once you determine that a host is live, you can use NMAP to scan for open ports. Use a TCP scan to determine which ports are open on Metasploitable2:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sS &lt;IP.addr.of.metasploitable2&gt;
</code></pre></div>    </div>

    <p>This scans approximately 1,800 of the most common TCP ports on the target machine.</p>

    <div class="alert alert-warning"><strong>Question: </strong>Which ports are open on the Metasploitable2 VM?</div>
  </li>
  <li>
    <p>You can also specify additional ports to scan. Scan the first 10,000 ports of the Metasploitable2 VM:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sS -p1-10000 &lt;IP.addr.of.metasploitable2&gt;
</code></pre></div>    </div>

    <div class="alert alert-warning"><strong>Question: </strong>Did you find any additional ports?</div>
  </li>
  <li>
    <p>Nmap can provide additional information about open ports by interrogating the ports it finds using the “sV” flag:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sV &lt;IP.addr.of.metasploitable2&gt;
</code></pre></div>    </div>

    <p><strong>Note:</strong> Press the “enter” key to see a status of the NMAP scan.</p>
  </li>
  <li>
    <p>You can get further information still by using the advanced flag (“-A”).</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sV -A &lt;IP.addr.of.metasploitable2&gt;
</code></pre></div>    </div>

    <div class="alert alert-warning"><strong>Question: </strong>What additional information about the open ports on Metasploitable2 were you able to obtain by using the -sV and -A flags?</div>
  </li>
  <li>
    <p>A useful feature of nmap is operating system fingerprinting which it accomplishes by profiling how a system responds to its scans.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -O &lt;IP.addr.of.metasploitable2&gt;
</code></pre></div>    </div>

    <p><strong>Note:</strong> That’s a capital “oh” not a “zero.”</p>

    <div class="alert alert-warning"><strong>Question: </strong>What operating system does nmap report Metasploitable2 to be? </div>
  </li>
  <li>
    <p>Now scan for web applications on Metasploitable2. Increasingly, applications run off of a different URL, all using port 80. Other <code class="highlighter-rouge">http</code>-protocl apps may run off of non-80 ports.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sV --script=http-enum &lt;IP.addr.of.metasploitable2&gt;
</code></pre></div>    </div>

    <div class="alert alert-warning"><strong>Question: </strong>What web applications are available on Metasploitable2?</div>
  </li>
</ol>

<h1 id="part-2-nessus">Part 2. Nessus</h1>

<p>If you are <span class="label label-danger">not</span> using my prepared VM, then <a href="/security-assignments/virtual-machines#install-nessus">install Nessus onto your Kali vm</a>. 
If you <span class="label label-primary">are</span> using my prepared Kali VM, then proceed with the steps below.</p>

<ol>
  <li>
    <p>In the Kali VM, open a terminal and type <code class="highlighter-rouge">service nessusd start</code></p>
  </li>
  <li>
    <p>On the Firefox web browser within Kali, navigate to <code class="highlighter-rouge">https://kali:8834</code> to open the Nessus web interface (note the <code class="highlighter-rouge">https</code>). (Click ‘Advanced’ &gt; ‘Add Security Exception’ &gt; ‘Confirm Security Exception’ to get past the SSL warning.)</p>
  </li>
  <li>
    <p>Login with username <code class="highlighter-rouge">root</code> and password <code class="highlighter-rouge">toor</code>. Click the “reload” if the page fails to load.</p>
  </li>
  <li>
    <p>Click the “Policies” tab and press the “New Policy” button.</p>

    <ol>
      <li>
        <p>Choose “Basic Network Scan”</p>
      </li>
      <li>
        <p>Name the policy “Metasploitable2 Scan”</p>
      </li>
      <li>
        <p>Under the category “Discovery,” change the “Scan Type” to “All ports.”</p>
      </li>
      <li>
        <p>Under “Assessment”, change the dropdown to “Scan for known web vulnerabilities.”</p>
      </li>
      <li>
        <p>Under “Advanced”, select Scan Type “Custom”. Then select “General” on the left. Uncheck “Enable safe checks.”</p>
      </li>
      <li>
        <p>Save your new custom policy.</p>
      </li>
    </ol>
  </li>
  <li>
    <p>Click the “Scans” tab and press the “New Scan” button.</p>

    <ol>
      <li>
        <p>Select the “User Defined” tab. Choose your Custom policy.</p>
      </li>
      <li>
        <p>In the “Name” field, enter “Metasploitable2” or something more cool-sounding. In the “Targets” field, enter the IP address of the MetaSploitable2 VM.</p>
      </li>
      <li>
        <p>Click the “Save” button, then click the “Scans” tab at the top of the web page. Next, on row of the Metasploitable2 scan you just created, click the triangle “play” symbol to launch the scan <i class="fa fa-rocket"></i>.</p>
      </li>
      <li>
        <p>Fist-bump your neighbor <i class="fa fa-hand-rock-o"></i> while Nessus starts throwing rocks at windows.</p>
      </li>
    </ol>
  </li>
  <li>
    <p>In the Scans tab you should see the scan job running. This should take about 10 minutes to complete. In the meantime, you can click the job to see the vulnerabilities that Nessus has found so far. Vulnerabilities can be sorted by severity.</p>
  </li>
</ol>

<div class="alert alert-warning"><strong>Question: </strong>Do you think it would be difficult to compromise this system? Explain.</div>

<div class="alert alert-warning"><strong>Question: </strong>Which vulnerabilities are critical? Of these, which appear to be most serious? Double-click a vulnerability in the report and read the description.</div>

<div class="alert alert-success"><strong>Consider:</strong> What would be the first thing you would do to secure this system?</div>




<script type='text/javascript'>
    var $ul = $('<ul></ul>').addClass('nav nav-pills');
    $('h1:not(.title)').each(function() {
        var anchor_location = $(this).text().toLowerCase().replace(/ /g, '-').replace(/,/g, '');
        $a = $('<a></a>').attr('href', '#' + anchor_location).text($(this).text());
        $li = $('<li></li>');
        $li.append($a);
        $ul.append($li);
    });
    $('#nav-bar').append($ul);
    
</script>

</div><!-- content -->
<div class="row">
	
	<div class="col-sm-10 col-sm-offset-1 footer">
	
		<div class="fine-print">
			<a href="/feed.xml">
				<i class="fa fa-rss"></i>
			</a>
			<a href="/fine-print/">Fine Print</a>
		</div>
	</div>
</div>

</div><!--/.container-->


<script src="/assets/vendor/anchor-js/anchor.min.js"></script>
<script>anchors.add('h3, h4, h5, h6');</script>

<script src="/assets/vendor/bootstrap-sass/assets/javascripts/bootstrap.min.js"></script>


	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-35065822-1', 'auto');
		ga('send', 'pageview', {
		  'page': '/security-assignments/lab_vulnerability_scanning/',
		  'title': 'Lab &ndash; Vulnerability Scanning'
		});
	</script>
	<!-- End Google Analytics -->



</body>
</html>
<!-- Powered by GitHub | Generated 2018-12-01 13:41:09 -0500 | Revision 92502d237dc856d080ccef6ea6f23eeb27ec96ab -->